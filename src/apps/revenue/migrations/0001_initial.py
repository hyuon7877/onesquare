# Generated by Django 4.2.14 on 2025-09-04 14:07

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Client',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200, verbose_name='고객명')),
                ('code', models.CharField(max_length=50, unique=True, verbose_name='고객 코드')),
                ('client_type', models.CharField(choices=[('corporate', '기업'), ('individual', '개인'), ('government', '정부기관'), ('ngo', '비영리단체')], max_length=20, verbose_name='고객 유형')),
                ('business_number', models.CharField(blank=True, max_length=20, verbose_name='사업자번호')),
                ('contact_person', models.CharField(blank=True, max_length=100, verbose_name='담당자')),
                ('phone', models.CharField(blank=True, max_length=20, verbose_name='연락처')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='이메일')),
                ('address', models.TextField(blank=True, verbose_name='주소')),
                ('notion_page_id', models.CharField(blank=True, max_length=50, verbose_name='Notion 페이지 ID')),
                ('notion_database_id', models.CharField(blank=True, max_length=50, verbose_name='Notion 데이터베이스 ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='활성 상태')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': '고객',
                'verbose_name_plural': '고객들',
                'db_table': 'client',
                'ordering': ['code'],
            },
        ),
        migrations.CreateModel(
            name='RevenueCategory',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100, verbose_name='카테고리명')),
                ('code', models.CharField(max_length=20, unique=True, verbose_name='카테고리 코드')),
                ('category_type', models.CharField(choices=[('project', '프로젝트 매출'), ('service', '서비스 매출'), ('product', '제품 매출'), ('consulting', '컨설팅 매출'), ('maintenance', '유지보수 매출'), ('other', '기타 매출')], max_length=20, verbose_name='카테고리 유형')),
                ('description', models.TextField(blank=True, verbose_name='설명')),
                ('is_active', models.BooleanField(default=True, verbose_name='활성 상태')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': '매출 카테고리',
                'verbose_name_plural': '매출 카테고리들',
                'db_table': 'revenue_category',
                'ordering': ['code'],
            },
        ),
        migrations.CreateModel(
            name='RevenueReport',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=200, verbose_name='리포트 제목')),
                ('report_type', models.CharField(choices=[('daily', '일간 리포트'), ('weekly', '주간 리포트'), ('monthly', '월간 리포트'), ('quarterly', '분기 리포트'), ('yearly', '연간 리포트'), ('custom', '커스텀 리포트')], max_length=20, verbose_name='리포트 유형')),
                ('report_format', models.CharField(choices=[('html', 'HTML'), ('pdf', 'PDF'), ('excel', 'Excel'), ('json', 'JSON')], max_length=20, verbose_name='리포트 형식')),
                ('start_date', models.DateField(verbose_name='시작일')),
                ('end_date', models.DateField(verbose_name='종료일')),
                ('filter_conditions', models.JSONField(default=dict, verbose_name='필터 조건')),
                ('report_data', models.JSONField(default=dict, verbose_name='리포트 데이터')),
                ('file_path', models.FileField(blank=True, null=True, upload_to='revenue_reports/', verbose_name='파일 경로')),
                ('is_generated', models.BooleanField(default=False, verbose_name='생성 완료')),
                ('generation_started_at', models.DateTimeField(blank=True, null=True, verbose_name='생성 시작 시간')),
                ('generation_completed_at', models.DateTimeField(blank=True, null=True, verbose_name='생성 완료 시간')),
                ('error_message', models.TextField(blank=True, verbose_name='오류 메시지')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='생성자')),
            ],
            options={
                'verbose_name': '매출 리포트',
                'verbose_name_plural': '매출 리포트들',
                'db_table': 'revenue_report',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RevenueAlert',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('alert_type', models.CharField(choices=[('target_achievement', '목표 달성'), ('overdue_payment', '연체 수금'), ('low_performance', '저조한 실적'), ('milestone_due', '마일스톤 기한'), ('monthly_report', '월간 리포트')], max_length=30, verbose_name='알림 유형')),
                ('alert_level', models.CharField(choices=[('info', '정보'), ('warning', '경고'), ('critical', '긴급')], max_length=20, verbose_name='알림 레벨')),
                ('target_roles', models.JSONField(default=list, verbose_name='알림 대상 역할')),
                ('threshold_value', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='임계값')),
                ('threshold_percentage', models.FloatField(blank=True, null=True, verbose_name='임계 비율')),
                ('is_active', models.BooleanField(default=True, verbose_name='활성 상태')),
                ('send_email', models.BooleanField(default=True, verbose_name='이메일 발송')),
                ('send_push', models.BooleanField(default=True, verbose_name='푸시 알림')),
                ('send_sms', models.BooleanField(default=False, verbose_name='SMS 발송')),
                ('title_template', models.CharField(max_length=200, verbose_name='제목 템플릿')),
                ('message_template', models.TextField(verbose_name='메시지 템플릿')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_revenue_alerts', to=settings.AUTH_USER_MODEL, verbose_name='생성자')),
                ('target_users', models.ManyToManyField(related_name='revenue_alerts', to=settings.AUTH_USER_MODEL, verbose_name='알림 대상 사용자')),
            ],
            options={
                'verbose_name': '매출 알림',
                'verbose_name_plural': '매출 알림들',
                'db_table': 'revenue_alert',
                'ordering': ['alert_type', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Project',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200, verbose_name='프로젝트명')),
                ('code', models.CharField(max_length=50, unique=True, verbose_name='프로젝트 코드')),
                ('status', models.CharField(choices=[('planning', '기획 단계'), ('in_progress', '진행 중'), ('completed', '완료'), ('cancelled', '취소'), ('on_hold', '보류')], default='planning', max_length=20, verbose_name='상태')),
                ('start_date', models.DateField(verbose_name='시작일')),
                ('end_date', models.DateField(verbose_name='종료일')),
                ('contract_amount', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='계약금액')),
                ('notion_page_id', models.CharField(blank=True, max_length=50, verbose_name='Notion 페이지 ID')),
                ('notion_database_id', models.CharField(blank=True, max_length=50, verbose_name='Notion 데이터베이스 ID')),
                ('description', models.TextField(blank=True, verbose_name='프로젝트 설명')),
                ('notes', models.TextField(blank=True, verbose_name='메모')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='revenue.revenuecategory', verbose_name='매출 카테고리')),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='revenue.client', verbose_name='고객')),
                ('project_manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='managed_projects', to=settings.AUTH_USER_MODEL, verbose_name='프로젝트 매니저')),
                ('team_members', models.ManyToManyField(blank=True, related_name='project_teams', to=settings.AUTH_USER_MODEL, verbose_name='팀원들')),
            ],
            options={
                'verbose_name': '프로젝트',
                'verbose_name_plural': '프로젝트들',
                'db_table': 'project',
                'ordering': ['-start_date', 'code'],
            },
        ),
        migrations.CreateModel(
            name='RevenueTarget',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('target_type', models.CharField(choices=[('monthly', '월별'), ('quarterly', '분기별'), ('yearly', '연간')], max_length=20, verbose_name='목표 유형')),
                ('year', models.IntegerField(verbose_name='년도')),
                ('month', models.IntegerField(blank=True, null=True, verbose_name='월 (월별 목표인 경우)')),
                ('quarter', models.IntegerField(blank=True, null=True, verbose_name='분기 (분기별 목표인 경우)')),
                ('target_amount', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='목표 금액')),
                ('description', models.TextField(blank=True, verbose_name='목표 설명')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='담당자별 목표')),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='revenue.revenuecategory', verbose_name='카테고리별 목표')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_targets', to=settings.AUTH_USER_MODEL, verbose_name='목표 설정자')),
            ],
            options={
                'verbose_name': '매출 목표',
                'verbose_name_plural': '매출 목표들',
                'db_table': 'revenue_target',
                'ordering': ['-year', '-month', '-quarter'],
                'unique_together': {('target_type', 'year', 'quarter', 'category', 'assigned_user'), ('target_type', 'year', 'month', 'category', 'assigned_user')},
            },
        ),
        migrations.CreateModel(
            name='RevenueRecord',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('revenue_type', models.CharField(choices=[('contract', '계약금'), ('milestone', '마일스톤'), ('monthly', '월 매출'), ('final', '최종 매출'), ('bonus', '보너스'), ('penalty', '페널티')], max_length=20, verbose_name='매출 유형')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='매출 금액')),
                ('tax_amount', models.DecimalField(decimal_places=2, default=Decimal('0'), max_digits=15, verbose_name='세금')),
                ('net_amount', models.DecimalField(decimal_places=2, max_digits=15, verbose_name='순 매출액')),
                ('revenue_date', models.DateField(verbose_name='매출 발생일')),
                ('invoice_date', models.DateField(blank=True, null=True, verbose_name='청구일')),
                ('due_date', models.DateField(blank=True, null=True, verbose_name='수금 예정일')),
                ('payment_date', models.DateField(blank=True, null=True, verbose_name='실제 수금일')),
                ('payment_status', models.CharField(choices=[('pending', '미수금'), ('partial', '부분 수금'), ('completed', '수금 완료'), ('overdue', '연체'), ('cancelled', '취소')], default='pending', max_length=20, verbose_name='수금 상태')),
                ('is_confirmed', models.BooleanField(default=False, verbose_name='확정 여부')),
                ('notion_page_id', models.CharField(blank=True, max_length=50, verbose_name='Notion 페이지 ID')),
                ('notion_database_id', models.CharField(blank=True, max_length=50, verbose_name='Notion 데이터베이스 ID')),
                ('last_synced_at', models.DateTimeField(blank=True, null=True, verbose_name='마지막 동기화')),
                ('description', models.TextField(blank=True, verbose_name='설명')),
                ('notes', models.TextField(blank=True, verbose_name='메모')),
                ('invoice_number', models.CharField(blank=True, max_length=50, verbose_name='청구서 번호')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='revenue.revenuecategory', verbose_name='매출 카테고리')),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='revenue.client', verbose_name='고객')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_revenues', to=settings.AUTH_USER_MODEL, verbose_name='등록자')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='revenue_records', to='revenue.project', verbose_name='프로젝트')),
                ('sales_person', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='sales_records', to=settings.AUTH_USER_MODEL, verbose_name='영업 담당자')),
            ],
            options={
                'verbose_name': '매출 기록',
                'verbose_name_plural': '매출 기록들',
                'db_table': 'revenue_record',
                'ordering': ['-revenue_date', '-created_at'],
                'indexes': [models.Index(fields=['revenue_date'], name='revenue_rec_revenue_17f315_idx'), models.Index(fields=['payment_status'], name='revenue_rec_payment_e454a2_idx'), models.Index(fields=['project', 'revenue_date'], name='revenue_rec_project_6f369a_idx'), models.Index(fields=['client', 'revenue_date'], name='revenue_rec_client__599fd2_idx'), models.Index(fields=['notion_page_id'], name='revenue_rec_notion__58fa46_idx')],
            },
        ),
    ]
